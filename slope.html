<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>3 Mode Slope Game</title>
<style>
    body { margin: 0; overflow: hidden; background: black; }
    #ui {
        position: absolute; 
        top: 0; left: 0;
        width: 100%; height: 100%;
        display: flex; 
        justify-content: center;
        align-items: center;
        flex-direction: column;
        background: rgba(0,0,0,0.8);
        color: white; font-family: Arial; font-size: 24px;
        z-index: 5;
    }
    button {
        margin: 10px;
        padding: 15px 30px;
        font-size: 24px;
        cursor: pointer;
        background: #111;
        color: lime;
        border: 2px solid lime;
        border-radius: 10px;
    }
</style>
</head>
<body>

<div id="ui">
    <h1>Select Mode</h1>
    <button onclick="start('tunnel')">Neon Tunnel</button>
    <button onclick="start('classic')">Classic Slope</button>
    <button onclick="start('hybrid')">Hybrid</button>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r146/three.min.js"></script>
<script>

let scene, camera, renderer, ball, mode;
let pieces = [];
let speed = 0.5;
let steer = 0;

// MAIN START
function start(m) {
    mode = m;
    document.getElementById("ui").style.display = "none";

    scene = new THREE.Scene();
    camera = new THREE.PerspectiveCamera(75, innerWidth/innerHeight, 0.1, 1000);
    camera.position.set(0, 3, 10);

    renderer = new THREE.WebGLRenderer({ antialias:true });
    renderer.setSize(innerWidth, innerHeight);
    document.body.appendChild(renderer.domElement);

    addLights();
    addBall();

    if (mode === "tunnel") buildTunnel();
    if (mode === "classic") buildSlope();
    if (mode === "hybrid") { buildSlope(); buildTunnel(true); }

    animate();
}

// LIGHTS
function addLights() {
    scene.add(new THREE.AmbientLight(0xffffff, 0.5));
    let p = new THREE.PointLight(0xffffff, 1);
    p.position.set(0, 10, 10);
    scene.add(p);
}

// PLAYER BALL
function addBall() {
    let g = new THREE.SphereGeometry(1, 32, 32);
    let m = new THREE.MeshStandardMaterial({ color: 0x00ff00, emissive: 0x00ff00 });
    ball = new THREE.Mesh(g, m);
    scene.add(ball);
    ball.position.set(0, 1, 0);
}

// CLASSIC SLOPE BLOCKS
function buildSlope() {
    let g = new THREE.BoxGeometry(12, 0.5, 20);
    for (let i = 0; i < 60; i++) {
        let m = new THREE.MeshBasicMaterial({ color: i % 2 ? 0xff0000 : 0x00ff00 });
        let p = new THREE.Mesh(g, m);

        p.position.set(0, -i * 1.5, -i * 20);
        pieces.push(p);
        scene.add(p);
    }
}

// NEON TUNNEL
function buildTunnel(offset=false) {
    for (let i = 0; i < 100; i++) {
        let g = new THREE.TorusGeometry(10, 0.5, 8, 80);
        let m = new THREE.MeshBasicMaterial({
            color: i % 2 ? 0xff0000 : 0x00ff00,
            side: THREE.DoubleSide
        });

        let t = new THREE.Mesh(g, m);
        t.rotation.x = Math.PI / 2;
        t.position.z = -i * 5;
        t.position.y = -50;

        if (offset) t.position.z -= 600;

        pieces.push(t);
        scene.add(t);
    }
}

// INPUT
addEventListener("keydown", e => {
    if (e.key === "a" || e.key === "ArrowLeft") steer = -1;
    if (e.key === "d" || e.key === "ArrowRight") steer = 1;
});
addEventListener("keyup", e => steer = 0);

// GAME LOOP
function animate() {
    requestAnimationFrame(animate);

    ball.position.x += steer * 0.5;

    pieces.forEach(p => {
        p.position.z += speed;
        if (p.position.z > 20) p.position.z -= 600;
    });

    camera.position.x = ball.position.x * 0.4;
    camera.lookAt(ball.position.x, ball.position.y, ball.position.z - 10);

    renderer.render(scene, camera);
}

onresize = () => {
    camera.aspect = innerWidth / innerHeight;
    camera.updateProjectionMatrix();
    renderer.setSize(innerWidth, innerHeight);
};
</script>
</body>
</html>
