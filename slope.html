<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>3-in-1 Slope Style Game</title>
<style>
    body { margin: 0; overflow: hidden; background: black; }
    #ui {
        position: absolute; 
        top: 0; left: 0; width: 100%; height: 100%;
        display: flex; 
        justify-content: center;
        align-items: center;
        flex-direction: column;
        background: rgba(0,0,0,0.8);
        color: white;
        font-family: Arial; 
        font-size: 24px;
        z-index: 10;
    }
    button {
        margin: 10px;
        padding: 15px 30px;
        font-size: 24px;
        cursor: pointer;
        background: #111;
        color: lime;
        border: 2px solid lime;
        border-radius: 10px;
    }
</style>
</head>
<body>

<div id="ui">
    <h1>Choose Game Mode</h1>
    <button onclick="startGame('tunnel')">Neon Tunnel</button>
    <button onclick="startGame('classic')">Classic Slope Track</button>
    <button onclick="startGame('hybrid')">Hybrid</button>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r146/three.min.js"></script>
<script>

//--------------------------------------
// BASIC THREE.JS SETUP
//--------------------------------------
let scene, camera, renderer, ball, mode;
let objects = [];
let speed = 0.25;
let lateralSpeed = 0.09;

function startGame(selectedMode) {
    mode = selectedMode;
    document.getElementById("ui").style.display = "none";

    scene = new THREE.Scene();
    camera = new THREE.PerspectiveCamera(
        75,
        window.innerWidth/window.innerHeight,
        0.1,
        1000
    );
    renderer = new THREE.WebGLRenderer({ antialias:true });
    renderer.setSize(window.innerWidth, window.innerHeight);
    document.body.appendChild(renderer.domElement);

    addLights();
    addBall();

    if (mode === "tunnel") generateTunnel();
    if (mode === "classic") generateSlope();
    if (mode === "hybrid") { generateSlope(); generateTunnel(true); }

    animate();
}

//--------------------------------------
// LIGHTS
//--------------------------------------
function addLights() {
    const amb = new THREE.AmbientLight(0x404040);
    scene.add(amb);

    const p = new THREE.PointLight(0xffffff, 1);
    p.position.set(0, 5, 0);
    scene.add(p);
}

//--------------------------------------
// BALL
//--------------------------------------
function addBall() {
    const geom = new THREE.SphereGeometry(1, 32, 32);
    const mat = new THREE.MeshStandardMaterial({
        color: 0x00ff00,
        emissive: 0x00ff00,
        emissiveIntensity: 0.7
    });
    ball = new THREE.Mesh(geom, mat);
    scene.add(ball);

    ball.position.set(0, 1, 0);
    camera.position.set(0, 2, 5);
}

//--------------------------------------
// GENERATE CLASSIC SLOPE TRACK (FLAT)
//--------------------------------------
function generateSlope() {
    const geometry = new THREE.BoxGeometry(12, 0.5, 20);

    for (let i = 0; i < 50; i++) {
        const material = new THREE.MeshBasicMaterial({
            color: (i % 2 === 0) ? 0x00ff00 : 0xff0000
        });
        const platform = new THREE.Mesh(geometry, material);
        platform.position.z = -i * 20;
        platform.position.y = -i * 1.2; 
        objects.push(platform);
        scene.add(platform);
    }
}

//--------------------------------------
// GENERATE TUNNEL (CYLINDER SECTIONS)
//--------------------------------------
function generateTunnel(offset=false) {
    const radius = 8;
    const thickness = 0.6;

    for (let i = 0; i < 80; i++) {
        const geom = new THREE.TorusGeometry(radius, thickness, 8, 100);
        const mat = new THREE.MeshBasicMaterial({
            color: (i % 2 === 0) ? 0x00ff00 : 0xff0000,
            side: THREE.DoubleSide
        });

        const ring = new THREE.Mesh(geom, mat);
        ring.rotation.x = Math.PI / 2;

        ring.position.z = -i * 4;
        if (offset) ring.position.z -= 800;

        ring.position.y = -50;

        objects.push(ring);
        scene.add(ring);
    }
}

//--------------------------------------
// KEY INPUT
//--------------------------------------
let steer = 0;
window.addEventListener("keydown", e => {
    if (e.key === "a" || e.key === "ArrowLeft") steer = -1;
    if (e.key === "d" || e.key === "ArrowRight") steer = 1;
});
window.addEventListener("keyup", e => {
    if (steer === -1 && (e.key === "a" || e.key === "ArrowLeft")) steer = 0;
    if (steer === 1 && (e.key === "d" || e.key === "ArrowRight")) steer = 0;
});

//--------------------------------------
// MAIN GAME LOOP
//--------------------------------------
function animate() {
    requestAnimationFrame(animate);

    ball.position.x += steer * lateralSpeed;

    // Move world backward = simulate ball moving forward
    objects.forEach(obj => {
        obj.position.z += speed;

        if (obj.position.z > camera.position.z + 10) {
            obj.position.z -= 2000;
        }
    });

    // Camera follows ball
    camera.position.x = ball.position.x * 0.4;
    camera.lookAt(ball.position.x, ball.position.y, ball.position.z - 10);

    renderer.render(scene, camera);
}

window.onresize = () => {
    camera.aspect = window.innerWidth / window.innerHeight;
    camera.updateProjectionMatrix();
    renderer.setSize(window.innerWidth, window.innerHeight);
};

</script>

</body>
</html>
